"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const commonHelper_1 = require("../../utils/commonHelper");
Page({
    data: {},
    onReady: function () {
        const currDate = commonHelper_1.toFormatString(new Date());
        const newBook = {
            bookName: '',
            _id: '',
            initDate: currDate,
            initAmount: 0,
            currency: 'CNY',
            currAmount: 0,
            desc: '',
        };
        this.setData(Object.assign({}, newBook));
    },
    onDateChange: function (event) {
        const { detail } = event;
        this.setData({
            initDate: detail,
        });
    },
    onNameChange: function (event) {
        const { detail: { value } } = event;
        this.setData({
            bookName: value,
        });
    },
    onAmountChange: function (event) {
        const { detail } = event;
        this.setData({
            initAmount: parseFloat(detail),
        });
    },
    onDescChange: function (event) {
        const { detail } = event;
        this.setData({
            desc: detail,
        });
    },
    onAddBook: function () {
        const book = this.data;
        const isBookValidRes = this.isBookValid(book);
        if (!isBookValidRes.isValid) {
            wx.showModal({
                title: '账户检测提示',
                content: isBookValidRes.msg,
                showCancel: false,
                confirmColor: '#3f98f3',
            });
        }
        else {
            wx.cloud.callFunction({
                name: "addBook",
                data: Object.assign({}, book),
            }).then(res => {
                console.log('调用success', res);
                wx.navigateBack({
                    delta: 0,
                });
            }).catch((err) => console.log(err));
        }
    },
    isBookValid: function (book) {
        let res = {
            isValid: true,
            msg: ''
        };
        if (!book.bookName) {
            res.isValid = false;
            res.msg = '账户名称不能为空！';
        }
        else if (!book.initAmount) {
            res.isValid = false;
            res.msg = '需要输入总资产';
        }
        else if (!book.initDate) {
            res.isValid = false;
            res.msg = '需要选中一个时间';
        }
        return res;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkQm9vay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImFkZEJvb2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyREFBeUQ7QUFRekQsSUFBSSxDQUFDO0lBS0gsSUFBSSxFQUFFLEVBQ0w7SUFLRCxPQUFPLEVBQUU7UUFDUCxNQUFNLFFBQVEsR0FBRyw2QkFBYyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQTtRQUMzQyxNQUFNLE9BQU8sR0FBVTtZQUNyQixRQUFRLEVBQUUsRUFBRTtZQUNaLEdBQUcsRUFBRSxFQUFFO1lBQ1AsUUFBUSxFQUFFLFFBQVE7WUFDbEIsVUFBVSxFQUFFLENBQUM7WUFDYixRQUFRLEVBQUUsS0FBSztZQUNmLFVBQVUsRUFBRSxDQUFDO1lBQ2IsSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFBO1FBQ0QsSUFBSSxDQUFDLE9BQU8sbUJBQ1AsT0FBTyxFQUNWLENBQUE7SUFDSixDQUFDO0lBU0QsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFBO1FBQ3hCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUE7UUFDbkMsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLFFBQVEsRUFBRSxLQUFLO1NBQ2hCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxjQUFjLEVBQUUsVUFBVSxLQUFVO1FBQ2xDLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUE7UUFDeEIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLFVBQVUsRUFBRSxVQUFVLENBQUMsTUFBTSxDQUFDO1NBQy9CLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxZQUFZLEVBQUUsVUFBVSxLQUFVO1FBQ2hDLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUE7UUFDeEIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLElBQUksRUFBRSxNQUFNO1NBQ2IsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELFNBQVMsRUFBRTtRQUNULE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFhLENBQUM7UUFDaEMsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUM3QyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRTtZQUMzQixFQUFFLENBQUMsU0FBUyxDQUFDO2dCQUNYLEtBQUssRUFBRSxRQUFRO2dCQUNmLE9BQU8sRUFBRSxjQUFjLENBQUMsR0FBRztnQkFDM0IsVUFBVSxFQUFFLEtBQUs7Z0JBQ2pCLFlBQVksRUFBRSxTQUFTO2FBQ3hCLENBQUMsQ0FBQTtTQUNIO2FBQU07WUFDTCxFQUFFLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQztnQkFDcEIsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsSUFBSSxvQkFDQyxJQUFJLENBQ1I7YUFDRixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFBO2dCQUM3QixFQUFFLENBQUMsWUFBWSxDQUFDO29CQUNkLEtBQUssRUFBRSxDQUFDO2lCQUNULENBQUMsQ0FBQTtZQUNKLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO1NBQ3BDO0lBQ0gsQ0FBQztJQUtELFdBQVcsRUFBRSxVQUFVLElBQVc7UUFDaEMsSUFBSSxHQUFHLEdBQWtCO1lBQ3ZCLE9BQU8sRUFBRSxJQUFJO1lBQ2IsR0FBRyxFQUFFLEVBQUU7U0FDUixDQUFBO1FBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDbEIsR0FBRyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7WUFDbkIsR0FBRyxDQUFDLEdBQUcsR0FBRyxXQUFXLENBQUE7U0FDdEI7YUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUMzQixHQUFHLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtZQUNuQixHQUFHLENBQUMsR0FBRyxHQUFHLFNBQVMsQ0FBQTtTQUNwQjthQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ3pCLEdBQUcsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFBO1lBQ25CLEdBQUcsQ0FBQyxHQUFHLEdBQUcsVUFBVSxDQUFBO1NBQ3JCO1FBRUQsT0FBTyxHQUFHLENBQUE7SUFDWixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdG9Gb3JtYXRTdHJpbmcgfSBmcm9tICcuLi8uLi91dGlscy9jb21tb25IZWxwZXInXG5pbXBvcnQgeyBJYm9vayB9IGZyb20gJy4uLy4uL2RhdGFNb2RlbC9kYXRhJ1xuXG5pbnRlcmZhY2UgSUJvb2tWYWlsZFJlcyB7XG4gIG1zZzogc3RyaW5nLFxuICBpc1ZhbGlkOiBCb29sZWFuXG59XG5cblBhZ2Uoe1xuXG4gIC8qKlxuICAgKiDpobXpnaLnmoTliJ3lp4vmlbDmja5cbiAgICovXG4gIGRhdGE6IHtcbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliJ3mrKHmuLLmn5PlrozmiJBcbiAgICovXG4gIG9uUmVhZHk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjdXJyRGF0ZSA9IHRvRm9ybWF0U3RyaW5nKG5ldyBEYXRlKCkpXG4gICAgY29uc3QgbmV3Qm9vazogSWJvb2sgPSB7XG4gICAgICBib29rTmFtZTogJycsXG4gICAgICBfaWQ6ICcnLFxuICAgICAgaW5pdERhdGU6IGN1cnJEYXRlLFxuICAgICAgaW5pdEFtb3VudDogMCxcbiAgICAgIGN1cnJlbmN5OiAnQ05ZJyxcbiAgICAgIGN1cnJBbW91bnQ6IDAsXG4gICAgICBkZXNjOiAnJyxcbiAgICB9XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIC4uLm5ld0Jvb2tcbiAgICB9KVxuICB9LFxuXG4gIC8qKlxuICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcbiAgICovXG4gIC8vIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG5cbiAgLy8gfSxcblxuICBvbkRhdGVDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgY29uc3QgeyBkZXRhaWwgfSA9IGV2ZW50XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGluaXREYXRlOiBkZXRhaWwsXG4gICAgfSlcbiAgfSxcblxuICBvbk5hbWVDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgY29uc3QgeyBkZXRhaWw6IHsgdmFsdWUgfSB9ID0gZXZlbnRcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgYm9va05hbWU6IHZhbHVlLFxuICAgIH0pXG4gIH0sXG5cbiAgb25BbW91bnRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgY29uc3QgeyBkZXRhaWwgfSA9IGV2ZW50XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGluaXRBbW91bnQ6IHBhcnNlRmxvYXQoZGV0YWlsKSxcbiAgICB9KVxuICB9LFxuXG4gIG9uRGVzY0NoYW5nZTogZnVuY3Rpb24gKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCB7IGRldGFpbCB9ID0gZXZlbnRcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZGVzYzogZGV0YWlsLFxuICAgIH0pXG4gIH0sXG5cbiAgb25BZGRCb29rOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYm9vayA9IHRoaXMuZGF0YSBhcyBJYm9vaztcbiAgICBjb25zdCBpc0Jvb2tWYWxpZFJlcyA9IHRoaXMuaXNCb29rVmFsaWQoYm9vaylcbiAgICBpZiAoIWlzQm9va1ZhbGlkUmVzLmlzVmFsaWQpIHtcbiAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgIHRpdGxlOiAn6LSm5oi35qOA5rWL5o+Q56S6JyxcbiAgICAgICAgY29udGVudDogaXNCb29rVmFsaWRSZXMubXNnLFxuICAgICAgICBzaG93Q2FuY2VsOiBmYWxzZSxcbiAgICAgICAgY29uZmlybUNvbG9yOiAnIzNmOThmMycsXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB3eC5jbG91ZC5jYWxsRnVuY3Rpb24oe1xuICAgICAgICBuYW1lOiBcImFkZEJvb2tcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIC4uLmJvb2tcbiAgICAgICAgfSxcbiAgICAgIH0pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ+iwg+eUqHN1Y2Nlc3MnLCByZXMpXG4gICAgICAgIHd4Lm5hdmlnYXRlQmFjayh7XG4gICAgICAgICAgZGVsdGE6IDAsXG4gICAgICAgIH0pXG4gICAgICB9KS5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICog5pWw5o2u5piv5ZCm5ZCI5rOVXG4gICAqL1xuICBpc0Jvb2tWYWxpZDogZnVuY3Rpb24gKGJvb2s6IElib29rKTogSUJvb2tWYWlsZFJlcyB7XG4gICAgbGV0IHJlczogSUJvb2tWYWlsZFJlcyA9IHtcbiAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICBtc2c6ICcnXG4gICAgfVxuXG4gICAgaWYgKCFib29rLmJvb2tOYW1lKSB7XG4gICAgICByZXMuaXNWYWxpZCA9IGZhbHNlXG4gICAgICByZXMubXNnID0gJ+i0puaIt+WQjeensOS4jeiDveS4uuepuu+8gSdcbiAgICB9IGVsc2UgaWYgKCFib29rLmluaXRBbW91bnQpIHtcbiAgICAgIHJlcy5pc1ZhbGlkID0gZmFsc2VcbiAgICAgIHJlcy5tc2cgPSAn6ZyA6KaB6L6T5YWl5oC76LWE5LqnJ1xuICAgIH0gZWxzZSBpZiAoIWJvb2suaW5pdERhdGUpIHtcbiAgICAgIHJlcy5pc1ZhbGlkID0gZmFsc2VcbiAgICAgIHJlcy5tc2cgPSAn6ZyA6KaB6YCJ5Lit5LiA5Liq5pe26Ze0J1xuICAgIH1cblxuICAgIHJldHVybiByZXNcbiAgfVxufSkiXX0=