"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const commonHelper_1 = require("../../utils/commonHelper");
Page({
    data: {},
    onReady: function () {
        const currDate = commonHelper_1.toFormatString(new Date());
        const newBook = {
            bookName: "",
            _id: "",
            initDate: currDate,
            initAmount: 0,
            currency: "CNY",
            currAmount: 0,
            desc: "",
        };
        this.setData(Object.assign({}, newBook));
    },
    onDateChange: function (event) {
        const { detail } = event;
        this.setData({
            initDate: detail,
        });
    },
    onNameChange: function (event) {
        const { detail } = event;
        this.setData({
            bookName: detail,
        });
    },
    onAmountChange: function (event) {
        const { detail } = event;
        this.setData({
            initAmount: parseFloat(detail),
        });
    },
    onDescChange: function (event) {
        const { detail } = event;
        this.setData({
            desc: detail,
        });
    },
    onAddBook: function () {
        const book = this.data;
        const isBookValidRes = this.isBookValid(book);
        if (!isBookValidRes.isValid) {
            wx.showModal({
                title: "账户检测提示",
                content: isBookValidRes.msg,
                showCancel: false,
                confirmColor: "#3f98f3",
            });
        }
        else {
            wx.cloud
                .callFunction({
                name: "addBook",
                data: Object.assign({}, book),
            })
                .then((res) => {
                console.log("调用success", res);
                wx.navigateBack({
                    delta: 0,
                });
            })
                .catch((err) => console.log(err));
        }
    },
    isBookValid: function (book) {
        let res = {
            isValid: true,
            msg: "",
        };
        if (!book.bookName) {
            res.isValid = false;
            res.msg = "账户名称不能为空！";
        }
        else if (!book.initAmount) {
            res.isValid = false;
            res.msg = "需要输入总资产";
        }
        else if (!book.initDate) {
            res.isValid = false;
            res.msg = "需要选中一个时间";
        }
        return res;
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkQm9vay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImFkZEJvb2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyREFBMEQ7QUFHMUQsSUFBSSxDQUFDO0lBSUgsSUFBSSxFQUFFLEVBQUU7SUFLUixPQUFPLEVBQUU7UUFDUCxNQUFNLFFBQVEsR0FBRyw2QkFBYyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM1QyxNQUFNLE9BQU8sR0FBVTtZQUNyQixRQUFRLEVBQUUsRUFBRTtZQUNaLEdBQUcsRUFBRSxFQUFFO1lBQ1AsUUFBUSxFQUFFLFFBQVE7WUFDbEIsVUFBVSxFQUFFLENBQUM7WUFDYixRQUFRLEVBQUUsS0FBSztZQUNmLFVBQVUsRUFBRSxDQUFDO1lBQ2IsSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFDO1FBQ0YsSUFBSSxDQUFDLE9BQU8sbUJBQ1AsT0FBTyxFQUNWLENBQUM7SUFDTCxDQUFDO0lBU0QsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsY0FBYyxFQUFFLFVBQVUsS0FBVTtRQUNsQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxVQUFVLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQztTQUMvQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxJQUFJLEVBQUUsTUFBTTtTQUNiLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxTQUFTLEVBQUU7UUFDVCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBYSxDQUFDO1FBQ2hDLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUU7WUFDM0IsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUUsUUFBUTtnQkFDZixPQUFPLEVBQUUsY0FBYyxDQUFDLEdBQUc7Z0JBQzNCLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixZQUFZLEVBQUUsU0FBUzthQUN4QixDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsRUFBRSxDQUFDLEtBQUs7aUJBQ0wsWUFBWSxDQUFDO2dCQUNaLElBQUksRUFBRSxTQUFTO2dCQUNmLElBQUksb0JBQ0MsSUFBSSxDQUNSO2FBQ0YsQ0FBQztpQkFDRCxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDWixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDOUIsRUFBRSxDQUFDLFlBQVksQ0FBQztvQkFDZCxLQUFLLEVBQUUsQ0FBQztpQkFDVCxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUM7aUJBQ0QsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDckM7SUFDSCxDQUFDO0lBS0QsV0FBVyxFQUFFLFVBQVUsSUFBVztRQUNoQyxJQUFJLEdBQUcsR0FBYztZQUNuQixPQUFPLEVBQUUsSUFBSTtZQUNiLEdBQUcsRUFBRSxFQUFFO1NBQ1IsQ0FBQztRQUVGLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2xCLEdBQUcsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ3BCLEdBQUcsQ0FBQyxHQUFHLEdBQUcsV0FBVyxDQUFDO1NBQ3ZCO2FBQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDM0IsR0FBRyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDcEIsR0FBRyxDQUFDLEdBQUcsR0FBRyxTQUFTLENBQUM7U0FDckI7YUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUN6QixHQUFHLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNwQixHQUFHLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQztTQUN0QjtRQUVELE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRvRm9ybWF0U3RyaW5nIH0gZnJvbSBcIi4uLy4uL3V0aWxzL2NvbW1vbkhlbHBlclwiO1xyXG5pbXBvcnQgeyBJQm9vaywgSVZhbGlkUmVzIH0gZnJvbSBcIi4uLy4uL2RhdGFNb2RlbC9kYXRhXCI7XHJcblxyXG5QYWdlKHtcclxuICAvKipcclxuICAgKiDpobXpnaLnmoTliJ3lp4vmlbDmja5cclxuICAgKi9cclxuICBkYXRhOiB7fSxcclxuXHJcbiAgLyoqXHJcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliJ3mrKHmuLLmn5PlrozmiJBcclxuICAgKi9cclxuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBjdXJyRGF0ZSA9IHRvRm9ybWF0U3RyaW5nKG5ldyBEYXRlKCkpO1xyXG4gICAgY29uc3QgbmV3Qm9vazogSUJvb2sgPSB7XHJcbiAgICAgIGJvb2tOYW1lOiBcIlwiLFxyXG4gICAgICBfaWQ6IFwiXCIsXHJcbiAgICAgIGluaXREYXRlOiBjdXJyRGF0ZSxcclxuICAgICAgaW5pdEFtb3VudDogMCxcclxuICAgICAgY3VycmVuY3k6IFwiQ05ZXCIsXHJcbiAgICAgIGN1cnJBbW91bnQ6IDAsXHJcbiAgICAgIGRlc2M6IFwiXCIsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgLi4ubmV3Qm9vayxcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIOeUqOaIt+eCueWHu+WPs+S4iuinkuWIhuS6q1xyXG4gICAqL1xyXG4gIC8vIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIC8vIH0sXHJcblxyXG4gIG9uRGF0ZUNoYW5nZTogZnVuY3Rpb24gKGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IHsgZGV0YWlsIH0gPSBldmVudDtcclxuICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgIGluaXREYXRlOiBkZXRhaWwsXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvbk5hbWVDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XHJcbiAgICBjb25zdCB7IGRldGFpbCB9ID0gZXZlbnQ7XHJcbiAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICBib29rTmFtZTogZGV0YWlsLFxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgb25BbW91bnRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XHJcbiAgICBjb25zdCB7IGRldGFpbCB9ID0gZXZlbnQ7XHJcbiAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICBpbml0QW1vdW50OiBwYXJzZUZsb2F0KGRldGFpbCksXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvbkRlc2NDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XHJcbiAgICBjb25zdCB7IGRldGFpbCB9ID0gZXZlbnQ7XHJcbiAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICBkZXNjOiBkZXRhaWwsXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvbkFkZEJvb2s6IGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IGJvb2sgPSB0aGlzLmRhdGEgYXMgSUJvb2s7XHJcbiAgICBjb25zdCBpc0Jvb2tWYWxpZFJlcyA9IHRoaXMuaXNCb29rVmFsaWQoYm9vayk7XHJcbiAgICBpZiAoIWlzQm9va1ZhbGlkUmVzLmlzVmFsaWQpIHtcclxuICAgICAgd3guc2hvd01vZGFsKHtcclxuICAgICAgICB0aXRsZTogXCLotKbmiLfmo4DmtYvmj5DnpLpcIixcclxuICAgICAgICBjb250ZW50OiBpc0Jvb2tWYWxpZFJlcy5tc2csXHJcbiAgICAgICAgc2hvd0NhbmNlbDogZmFsc2UsXHJcbiAgICAgICAgY29uZmlybUNvbG9yOiBcIiMzZjk4ZjNcIixcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB3eC5jbG91ZFxyXG4gICAgICAgIC5jYWxsRnVuY3Rpb24oe1xyXG4gICAgICAgICAgbmFtZTogXCJhZGRCb29rXCIsXHJcbiAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIC4uLmJvb2ssXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCLosIPnlKhzdWNjZXNzXCIsIHJlcyk7XHJcbiAgICAgICAgICB3eC5uYXZpZ2F0ZUJhY2soe1xyXG4gICAgICAgICAgICBkZWx0YTogMCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIOaVsOaNruaYr+WQpuWQiOazlVxyXG4gICAqL1xyXG4gIGlzQm9va1ZhbGlkOiBmdW5jdGlvbiAoYm9vazogSUJvb2spOiBJVmFsaWRSZXMge1xyXG4gICAgbGV0IHJlczogSVZhbGlkUmVzID0ge1xyXG4gICAgICBpc1ZhbGlkOiB0cnVlLFxyXG4gICAgICBtc2c6IFwiXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIGlmICghYm9vay5ib29rTmFtZSkge1xyXG4gICAgICByZXMuaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICByZXMubXNnID0gXCLotKbmiLflkI3np7DkuI3og73kuLrnqbrvvIFcIjtcclxuICAgIH0gZWxzZSBpZiAoIWJvb2suaW5pdEFtb3VudCkge1xyXG4gICAgICByZXMuaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICByZXMubXNnID0gXCLpnIDopoHovpPlhaXmgLvotYTkuqdcIjtcclxuICAgIH0gZWxzZSBpZiAoIWJvb2suaW5pdERhdGUpIHtcclxuICAgICAgcmVzLmlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgcmVzLm1zZyA9IFwi6ZyA6KaB6YCJ5Lit5LiA5Liq5pe26Ze0XCI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcztcclxuICB9LFxyXG59KTtcclxuIl19