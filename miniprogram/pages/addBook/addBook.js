"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const commonHelper_1 = require("../../utils/commonHelper");
Page({
    data: {},
    onReady: function () {
        const currDate = commonHelper_1.toFormatString(new Date());
        const newBook = {
            bookName: "",
            _id: "",
            initDate: currDate,
            initAmount: 0,
            currency: "CNY",
            currAmount: 0,
            desc: "",
        };
        this.setData(Object.assign({}, newBook));
    },
    onDateChange: function (event) {
        const { detail } = event;
        this.setData({
            initDate: detail,
        });
    },
    onNameChange: function (event) {
        const { detail } = event;
        this.setData({
            bookName: detail,
        });
    },
    onAmountChange: function (event) {
        const { detail } = event;
        this.setData({
            initAmount: parseFloat(detail),
        });
    },
    onDescChange: function (event) {
        const { detail } = event;
        this.setData({
            desc: detail,
        });
    },
    onAddBook: function () {
        const book = this.data;
        const isBookValidRes = this.isBookValid(book);
        if (!isBookValidRes.isValid) {
            wx.showModal({
                title: "账户检测提示",
                content: isBookValidRes.msg,
                showCancel: false,
                confirmColor: "#3f98f3",
            });
        }
        else {
            wx.cloud
                .callFunction({
                name: "addBook",
                data: Object.assign({}, book),
            })
                .then((res) => {
                console.log("调用success", res);
                wx.navigateBack({
                    delta: 0,
                });
            })
                .catch((err) => console.log(err));
        }
    },
    isBookValid: function (book) {
        let res = {
            isValid: true,
            msg: "",
        };
        if (!book.bookName) {
            res.isValid = false;
            res.msg = "账户名称不能为空！";
        }
        else if (!book.initAmount) {
            res.isValid = false;
            res.msg = "需要输入总资产";
        }
        else if (!book.initDate) {
            res.isValid = false;
            res.msg = "需要选中一个时间";
        }
        return res;
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkQm9vay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImFkZEJvb2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyREFBMEQ7QUFRMUQsSUFBSSxDQUFDO0lBSUgsSUFBSSxFQUFFLEVBQUU7SUFLUixPQUFPLEVBQUU7UUFDUCxNQUFNLFFBQVEsR0FBRyw2QkFBYyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM1QyxNQUFNLE9BQU8sR0FBVTtZQUNyQixRQUFRLEVBQUUsRUFBRTtZQUNaLEdBQUcsRUFBRSxFQUFFO1lBQ1AsUUFBUSxFQUFFLFFBQVE7WUFDbEIsVUFBVSxFQUFFLENBQUM7WUFDYixRQUFRLEVBQUUsS0FBSztZQUNmLFVBQVUsRUFBRSxDQUFDO1lBQ2IsSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFDO1FBQ0YsSUFBSSxDQUFDLE9BQU8sbUJBQ1AsT0FBTyxFQUNWLENBQUM7SUFDTCxDQUFDO0lBU0QsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxRQUFRLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsY0FBYyxFQUFFLFVBQVUsS0FBVTtRQUNsQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxVQUFVLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQztTQUMvQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWSxFQUFFLFVBQVUsS0FBVTtRQUNoQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDWCxJQUFJLEVBQUUsTUFBTTtTQUNiLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxTQUFTLEVBQUU7UUFDVCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBYSxDQUFDO1FBQ2hDLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUU7WUFDM0IsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDWCxLQUFLLEVBQUUsUUFBUTtnQkFDZixPQUFPLEVBQUUsY0FBYyxDQUFDLEdBQUc7Z0JBQzNCLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixZQUFZLEVBQUUsU0FBUzthQUN4QixDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsRUFBRSxDQUFDLEtBQUs7aUJBQ0wsWUFBWSxDQUFDO2dCQUNaLElBQUksRUFBRSxTQUFTO2dCQUNmLElBQUksb0JBQ0MsSUFBSSxDQUNSO2FBQ0YsQ0FBQztpQkFDRCxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDWixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDOUIsRUFBRSxDQUFDLFlBQVksQ0FBQztvQkFDZCxLQUFLLEVBQUUsQ0FBQztpQkFDVCxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUM7aUJBQ0QsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDckM7SUFDSCxDQUFDO0lBS0QsV0FBVyxFQUFFLFVBQVUsSUFBVztRQUNoQyxJQUFJLEdBQUcsR0FBa0I7WUFDdkIsT0FBTyxFQUFFLElBQUk7WUFDYixHQUFHLEVBQUUsRUFBRTtTQUNSLENBQUM7UUFFRixJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNsQixHQUFHLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNwQixHQUFHLENBQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQztTQUN2QjthQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQzNCLEdBQUcsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ3BCLEdBQUcsQ0FBQyxHQUFHLEdBQUcsU0FBUyxDQUFDO1NBQ3JCO2FBQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDekIsR0FBRyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDcEIsR0FBRyxDQUFDLEdBQUcsR0FBRyxVQUFVLENBQUM7U0FDdEI7UUFFRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0b0Zvcm1hdFN0cmluZyB9IGZyb20gXCIuLi8uLi91dGlscy9jb21tb25IZWxwZXJcIjtcbmltcG9ydCB7IElib29rIH0gZnJvbSBcIi4uLy4uL2RhdGFNb2RlbC9kYXRhXCI7XG5cbmludGVyZmFjZSBJQm9va1ZhaWxkUmVzIHtcbiAgbXNnOiBzdHJpbmc7XG4gIGlzVmFsaWQ6IEJvb2xlYW47XG59XG5cblBhZ2Uoe1xuICAvKipcbiAgICog6aG16Z2i55qE5Yid5aeL5pWw5o2uXG4gICAqL1xuICBkYXRhOiB7fSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliJ3mrKHmuLLmn5PlrozmiJBcbiAgICovXG4gIG9uUmVhZHk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjdXJyRGF0ZSA9IHRvRm9ybWF0U3RyaW5nKG5ldyBEYXRlKCkpO1xuICAgIGNvbnN0IG5ld0Jvb2s6IElib29rID0ge1xuICAgICAgYm9va05hbWU6IFwiXCIsXG4gICAgICBfaWQ6IFwiXCIsXG4gICAgICBpbml0RGF0ZTogY3VyckRhdGUsXG4gICAgICBpbml0QW1vdW50OiAwLFxuICAgICAgY3VycmVuY3k6IFwiQ05ZXCIsXG4gICAgICBjdXJyQW1vdW50OiAwLFxuICAgICAgZGVzYzogXCJcIixcbiAgICB9O1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAuLi5uZXdCb29rLFxuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcbiAgICovXG4gIC8vIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG5cbiAgLy8gfSxcblxuICBvbkRhdGVDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgY29uc3QgeyBkZXRhaWwgfSA9IGV2ZW50O1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBpbml0RGF0ZTogZGV0YWlsLFxuICAgIH0pO1xuICB9LFxuXG4gIG9uTmFtZUNoYW5nZTogZnVuY3Rpb24gKGV2ZW50OiBhbnkpIHtcbiAgICBjb25zdCB7IGRldGFpbCB9ID0gZXZlbnQ7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGJvb2tOYW1lOiBkZXRhaWwsXG4gICAgfSk7XG4gIH0sXG5cbiAgb25BbW91bnRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgY29uc3QgeyBkZXRhaWwgfSA9IGV2ZW50O1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBpbml0QW1vdW50OiBwYXJzZUZsb2F0KGRldGFpbCksXG4gICAgfSk7XG4gIH0sXG5cbiAgb25EZXNjQ2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQ6IGFueSkge1xuICAgIGNvbnN0IHsgZGV0YWlsIH0gPSBldmVudDtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZGVzYzogZGV0YWlsLFxuICAgIH0pO1xuICB9LFxuXG4gIG9uQWRkQm9vazogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJvb2sgPSB0aGlzLmRhdGEgYXMgSWJvb2s7XG4gICAgY29uc3QgaXNCb29rVmFsaWRSZXMgPSB0aGlzLmlzQm9va1ZhbGlkKGJvb2spO1xuICAgIGlmICghaXNCb29rVmFsaWRSZXMuaXNWYWxpZCkge1xuICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgdGl0bGU6IFwi6LSm5oi35qOA5rWL5o+Q56S6XCIsXG4gICAgICAgIGNvbnRlbnQ6IGlzQm9va1ZhbGlkUmVzLm1zZyxcbiAgICAgICAgc2hvd0NhbmNlbDogZmFsc2UsXG4gICAgICAgIGNvbmZpcm1Db2xvcjogXCIjM2Y5OGYzXCIsXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgd3guY2xvdWRcbiAgICAgICAgLmNhbGxGdW5jdGlvbih7XG4gICAgICAgICAgbmFtZTogXCJhZGRCb29rXCIsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgLi4uYm9vayxcbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLosIPnlKhzdWNjZXNzXCIsIHJlcyk7XG4gICAgICAgICAgd3gubmF2aWdhdGVCYWNrKHtcbiAgICAgICAgICAgIGRlbHRhOiAwLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiDmlbDmja7mmK/lkKblkIjms5VcbiAgICovXG4gIGlzQm9va1ZhbGlkOiBmdW5jdGlvbiAoYm9vazogSWJvb2spOiBJQm9va1ZhaWxkUmVzIHtcbiAgICBsZXQgcmVzOiBJQm9va1ZhaWxkUmVzID0ge1xuICAgICAgaXNWYWxpZDogdHJ1ZSxcbiAgICAgIG1zZzogXCJcIixcbiAgICB9O1xuXG4gICAgaWYgKCFib29rLmJvb2tOYW1lKSB7XG4gICAgICByZXMuaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgcmVzLm1zZyA9IFwi6LSm5oi35ZCN56ew5LiN6IO95Li656m677yBXCI7XG4gICAgfSBlbHNlIGlmICghYm9vay5pbml0QW1vdW50KSB7XG4gICAgICByZXMuaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgcmVzLm1zZyA9IFwi6ZyA6KaB6L6T5YWl5oC76LWE5LqnXCI7XG4gICAgfSBlbHNlIGlmICghYm9vay5pbml0RGF0ZSkge1xuICAgICAgcmVzLmlzVmFsaWQgPSBmYWxzZTtcbiAgICAgIHJlcy5tc2cgPSBcIumcgOimgemAieS4reS4gOS4quaXtumXtFwiO1xuICAgIH1cblxuICAgIHJldHVybiByZXM7XG4gIH0sXG59KTtcbiJdfQ==